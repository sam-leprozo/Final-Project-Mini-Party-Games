<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Multiplayer Game</title>
    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        #playButton { padding: 10px 20px; font-size: 20px; cursor: not-allowed; }
    </style>
</head>
<body>
    <h1>Multiplayer Game</h1>
    <p id="playerCount">Players Connected: 0</p>
    <button id="playButton" disabled>Play</button>

    <script>
        const socket = io();

        // Track the player count
        let playerCount = 0;

        // Update player count on the UI
        socket.on('update_player_count', count => {
            playerCount = count;
            document.getElementById('playerCount').innerText = `Players Connected: ${playerCount}`;
            updatePlayButtonState();
        });

        // Start the game
        socket.on('start_game', () => {
            alert('Game is starting!');
        });

        // Error message if not enough players
        socket.on('error_message', msg => {
            alert(msg);
        });

        // Enable/disable the Play button
        function updatePlayButtonState() {
            const playButton = document.getElementById('playButton');
            if (playerCount >= 4 && playerCount <= 6) {
                playButton.disabled = false;
                playButton.style.cursor = 'pointer';
            } else {
                playButton.disabled = true;
                playButton.style.cursor = 'not-allowed';
            }
        }

        // Simulate player joining on page load
        socket.emit('player_joined');

        // Handle Play button click
        document.getElementById('playButton').addEventListener('click', () => {
            socket.emit('play_game');
        });

        // Simulate player leaving when the page is closed
        window.addEventListener('beforeunload', () => {
            socket.emit('player_left');
        });
    </script>
</body>
</html>
